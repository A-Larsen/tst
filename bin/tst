#!/bin/bash

tstdir=/usr/local/share/tst/
cd $tstdir
templatePath=${tstdir}templates/"$1"/

open(){
	if [[ ! -d "$1" ]]; then
		return
	fi

    cd $1
    rm -R *

    cat ${templatePath}/"$2" > tst."$1"
    chmod +x tst."$1"
}

if (( $# > 0 )); then
    while (( $# != 0 )); do
        case $1 in
                py|c|cpp|js|sh|pl|kts|java|s|vim|lua|nasm)
                break
            ;;
            *)
                echo "argument \"${1}\" is not valid"
                exit 1
            ;;
        esac
    done
else
    echo "arguments are required"
    exit 2
fi

if (( $# > 1 )); then
    open $1 "$2"
else
    open $1 "default"
fi

nvim -S "${tstdir}/commands.vim" tst."$1" 
